geom_smooth(method=lm, color = "grey") +
my.theme + ggtitle("Political Support Correlated to Public Opinion") +
xlab("Percent of State's Politicans Who Support - R-Sq=.79")+
ylab("Percent Who Say They Support in Recent Polls") +
scale_y_continuous(labels = percent) +
scale_x_continuous(labels = percent)
ggsave("./plots/plot01.png", dpi=300, width=5, height=4)
ggplot(d, aes(x=d$PercOfPolsOpp,
y=(d$X..opposition / 100), color=Majority)) +
geom_point(shape=1) + #scale_x_log10() +
scale_color_manual(values = c(purple, pinkish_red, dark_blue)) +
geom_smooth(method=lm, color = "grey") +
my.theme + ggtitle("Political Opposition Correlated to Public Opinion") +
xlab("Percent of State's Politicans Who Oppose - R-Sq=.79")+
ylab("Percent Who Say They Oppose in Recent Polls") +
scale_y_continuous(labels = percent) +
scale_x_continuous(labels = percent)
ggsave("./plots/plot02.png", dpi=300, width=5, height=4)
d.top <- d[which(d$PercOfPolsOpp == 1),]
ggplot(d.top, aes(x=reorder(d.top$state, -d.top$POPEST18PLUS2013), y=d.top$POPEST18PLUS2013)) + geom_bar(colour="white", fill=teele) +
my.theme + ggtitle("All States Where 100% of Politicans Oppose") + xlab("State")+
ylab("18+ Population") +
scale_y_continuous(labels = comma)
ggsave("./plots/plot03.png", dpi=300, width=5, height=4)
d.top <- d[which(d$PercOfPolsSupp == 1),]
ggplot(d.top, aes(x=reorder(d.top$state, -d.top$POPEST18PLUS2013), y=d.top$POPEST18PLUS2013)) +
geom_bar(colour="white", fill=dark_blue) +
my.theme + ggtitle("All States Where 100% of Politicans Support") + xlab("State")+
ylab("18+ Population") +
scale_y_continuous(labels = comma)
ggsave("./plots/plot04.png", dpi=300, width=5, height=4)
ggplot(d, aes(x=(d$support / 100))) + geom_histogram(colour="white", fill=middle_blue, binwidth = .05) +
my.theme + ggtitle("Public Support for Gay Marriage") +
xlab("Percent of State Who Say They Support")+
ylab("Number of States") +
scale_x_continuous(labels = percent)
ggsave("./plots/plot05.png", dpi=300, width=5, height=4)
ggplot(d, aes(x=d$PercOfPolsSupp)) + geom_histogram(colour="white", fill=middle_blue, binwidth = .1) +
my.theme + ggtitle("Political Support for Gay Marriage") +
xlab("% of State Politicians Who Support")+
ylab("Number of States") +
scale_x_continuous(labels = percent)
ggsave("./plots/plot06.png", dpi=300, width=5, height=4)
d.top <- d[which(d$GovsOppose == 1 & d$support > 50),]
ggplot(d.top, aes(x=reorder(d.top$state, -d.top$POPEST18PLUS2013), y=d.top$POPEST18PLUS2013)) + geom_bar(colour="white", fill=teele) +
my.theme + ggtitle("Governor Opposes But the Majority Support") + xlab("State")+
ylab("18+ Population") +
scale_y_continuous(labels = comma)
ggsave("./plots/plot07.png", dpi=300, width=5, height=4)
d.top <- d[which(d$SenatorsOppose >= 1 & d$support > 50),]
ggplot(d.top, aes(x=reorder(d.top$state, -d.top$POPEST18PLUS2013), y=d.top$POPEST18PLUS2013)) + geom_bar(colour="white", fill=teele) +
my.theme + ggtitle("A Senator Opposes But the Majority Support") + xlab("State")+
ylab("18+ Population") +
scale_y_continuous(labels = comma)
ggsave("./plots/plot08.png", dpi=300, width=5, height=4)
# Politicians For and Against Gay Marriage
# Created by Daniel Hadley to analyze the support for gay marriage
# Nov, 2014
setwd("/Users/dphnrome/Documents/Git/SameSexMarriage/")
# setwd("C:/Users/dhadley/Documents/GitHub/SameSexMarriage")
#### Load packages and data ####
library(XML)
library(ggplot2)
library(maps)
library(reshape2)
library(plyr)
library(stringr)
library(scales)
# congress data: https://www.govtrack.us/data/congress-legislators/
congress <- read.csv("./data/legislators-current.csv")
abbreviations <- read.csv("./data//us_states.csv", header=F)
congress <- merge(congress, abbreviations, by.x="state", by.y="V3", all.x=T)
remove(abbreviations)
# More congress data: https://sunlightlabs.github.io/congress/#legislator-spreadsheet
congressSunlight <- read.csv("./data//legislators-sunlight.csv")
# House data scrapped from:
# wikipedia.org/wiki/Current_members_of_the_United_States_House_of_Representatives
house <- read.csv("./data//HouseOfReps.csv")
house$Name <- as.character(house$Name)
house$Name <- substring(house$Name, ((nchar(house$Name)/2)+2))
# States data from https://www.census.gov/popest/data/state/asrh/2013/files/SCPRC-EST2013-18+POP-RES.csv
# Population for 18+
# stopped using this because population is not a useful denominator
# Now just used to make the list for wikipedia mining
states <- read.csv("./data/States.csv")
# Data created from MungeData script
PollsByState <- read.csv("./data//PollsByState.csv")
PolsByState <- read.csv("./data/PolsByState.csv")
SupportersFinal <- read.csv("./data//SupportersFinal.csv")
OpponentsFinal <- read.csv("./data/OpponentsFinal.csv")
#### Prepares data for visualizations #####
d <- merge(PollsByState, PolsByState, by.x="state", by.y="State")
d <- merge(d, states, by.x="state", by.y="NAME")
d$Majority <- ifelse(d$support > 50, "Support",
ifelse(d$X..opposition > 50, "Oppose", "No Majority"))
# add my theme and colors that match the maps
pinkish_red = "#e74c3c"
purple = "#9b59b6"
dark_blue = "#0c2c84"
middle_blue = "#1d91c0"
teele = "#c7e9b4"
yellow = "#ffffcc"
my.theme <-
theme(#plot.background = element_rect(fill="white"), # Remove background
panel.grid.major = element_blank(), # Remove gridlines
# panel.grid.minor = element_blank(), # Remove more gridlines
# panel.border = element_blank(), # Remove border
panel.background = element_blank(), # Remove more background
axis.ticks = element_blank(), # Remove axis ticks
axis.text=element_text(size=6), # Enlarge axis text font
axis.title=element_text(size=8), # Enlarge axis title font
plot.title=element_text(size=12) # Enlarge, left-align title
,axis.text.x = element_text(angle=60, hjust = 1) # Uncomment if X-axis unreadable
)
summary(lm(d$PercOfPolsSupp ~ d$support))$r.squared
ggplot(d, aes(x=d$PercOfPolsSupp,
y=(d$support / 100), color=Majority)) +
geom_point(shape=1) + #scale_x_log10() +
scale_color_manual(values = c(purple, pinkish_red, dark_blue)) +
geom_smooth(method=lm, color = "grey") +
my.theme + ggtitle("Political Support Correlated to Public Opinion") +
xlab("Percent of State's Politicans Who Support - R-Sq=.79")+
ylab("Percent Who Say They Support in Recent Polls") +
scale_y_continuous(labels = percent) +
scale_x_continuous(labels = percent)
ggsave("./plots/plot01.png", dpi=300, width=5, height=4)
ggplot(d, aes(x=d$PercOfPolsOpp,
y=(d$X..opposition / 100), color=Majority)) +
geom_point(shape=1) + #scale_x_log10() +
scale_color_manual(values = c(purple, pinkish_red, dark_blue)) +
geom_smooth(method=lm, color = "grey") +
my.theme + ggtitle("Political Opposition Correlated to Public Opinion") +
xlab("Percent of State's Politicans Who Oppose - R-Sq=.79")+
ylab("Percent Who Say They Oppose in Recent Polls") +
scale_y_continuous(labels = percent) +
scale_x_continuous(labels = percent)
ggsave("./plots/plot02.png", dpi=300, width=5, height=4)
d.top <- d[which(d$PercOfPolsOpp == 1),]
ggplot(d.top, aes(x=reorder(d.top$state, -d.top$POPEST18PLUS2013), y=d.top$POPEST18PLUS2013)) + geom_bar(colour="white", fill=middle_blue) +
my.theme + ggtitle("All States Where 100% of Politicans Oppose") + xlab("State")+
ylab("18+ Population") +
scale_y_continuous(labels = comma)
ggsave("./plots/plot03.png", dpi=300, width=5, height=4)
d.top <- d[which(d$PercOfPolsSupp == 1),]
ggplot(d.top, aes(x=reorder(d.top$state, -d.top$POPEST18PLUS2013), y=d.top$POPEST18PLUS2013)) +
geom_bar(colour="white", fill=dark_blue) +
my.theme + ggtitle("All States Where 100% of Politicans Support") + xlab("State")+
ylab("18+ Population") +
scale_y_continuous(labels = comma)
ggsave("./plots/plot04.png", dpi=300, width=5, height=4)
ggplot(d, aes(x=(d$support / 100))) + geom_histogram(colour="white", fill=middle_blue, binwidth = .05) +
my.theme + ggtitle("Public Support for Gay Marriage") +
xlab("Percent of State Who Say They Support")+
ylab("Number of States") +
scale_x_continuous(labels = percent)
ggsave("./plots/plot05.png", dpi=300, width=5, height=4)
ggplot(d, aes(x=d$PercOfPolsSupp)) + geom_histogram(colour="white", fill=middle_blue, binwidth = .1) +
my.theme + ggtitle("Political Support for Gay Marriage") +
xlab("% of State Politicians Who Support")+
ylab("Number of States") +
scale_x_continuous(labels = percent)
ggsave("./plots/plot06.png", dpi=300, width=5, height=4)
d.top <- d[which(d$GovsOppose == 1 & d$support > 50),]
ggplot(d.top, aes(x=reorder(d.top$state, -d.top$POPEST18PLUS2013), y=d.top$POPEST18PLUS2013)) + geom_bar(colour="white", fill=middle_blue) +
my.theme + ggtitle("Governor Opposes But the Majority Support") + xlab("State")+
ylab("18+ Population") +
scale_y_continuous(labels = comma)
ggsave("./plots/plot07.png", dpi=300, width=5, height=4)
d.top <- d[which(d$SenatorsOppose >= 1 & d$support > 50),]
ggplot(d.top, aes(x=reorder(d.top$state, -d.top$POPEST18PLUS2013), y=d.top$POPEST18PLUS2013)) + geom_bar(colour="white", fill=middle_blue) +
my.theme + ggtitle("A Senator Opposes But the Majority Support") + xlab("State")+
ylab("18+ Population") +
scale_y_continuous(labels = comma)
ggsave("./plots/plot08.png", dpi=300, width=5, height=4)
# Politicians For and Against Gay Marriage
# Created by Daniel Hadley to analyze the support for gay marriage
# Nov, 2014
setwd("/Users/dphnrome/Documents/Git/SameSexMarriage/")
# setwd("C:/Users/dhadley/Documents/GitHub/SameSexMarriage")
#### Load packages and data ####
library(XML)
library(ggplot2)
library(maps)
library(reshape2)
library(plyr)
library(stringr)
library(scales)
# congress data: https://www.govtrack.us/data/congress-legislators/
congress <- read.csv("./data/legislators-current.csv")
abbreviations <- read.csv("./data//us_states.csv", header=F)
congress <- merge(congress, abbreviations, by.x="state", by.y="V3", all.x=T)
remove(abbreviations)
# More congress data: https://sunlightlabs.github.io/congress/#legislator-spreadsheet
congressSunlight <- read.csv("./data//legislators-sunlight.csv")
# House data scrapped from:
# wikipedia.org/wiki/Current_members_of_the_United_States_House_of_Representatives
house <- read.csv("./data//HouseOfReps.csv")
house$Name <- as.character(house$Name)
house$Name <- substring(house$Name, ((nchar(house$Name)/2)+2))
# States data from https://www.census.gov/popest/data/state/asrh/2013/files/SCPRC-EST2013-18+POP-RES.csv
# Population for 18+
# stopped using this because population is not a useful denominator
# Now just used to make the list for wikipedia mining
states <- read.csv("./data/States.csv")
# Data created from MungeData script
PollsByState <- read.csv("./data//PollsByState.csv")
PolsByState <- read.csv("./data/PolsByState.csv")
SupportersFinal <- read.csv("./data//SupportersFinal.csv")
OpponentsFinal <- read.csv("./data/OpponentsFinal.csv")
#### Prepares data for visualizations #####
d <- merge(PollsByState, PolsByState, by.x="state", by.y="State")
d <- merge(d, states, by.x="state", by.y="NAME")
d$Majority <- ifelse(d$support > 50, "Support",
ifelse(d$X..opposition > 50, "Oppose", "No Majority"))
# add my theme and colors that match the maps
pinkish_red = "#e74c3c"
purple = "#9b59b6"
dark_blue = "#0c2c84"
middle_blue = "#1d91c0"
teele = "#c7e9b4"
yellow = "#ffffcc"
my.theme <-
theme(#plot.background = element_rect(fill="white"), # Remove background
panel.grid.major = element_blank(), # Remove gridlines
# panel.grid.minor = element_blank(), # Remove more gridlines
# panel.border = element_blank(), # Remove border
panel.background = element_blank(), # Remove more background
axis.ticks = element_blank(), # Remove axis ticks
axis.text=element_text(size=6), # Enlarge axis text font
axis.title=element_text(size=8), # Enlarge axis title font
plot.title=element_text(size=12) # Enlarge, left-align title
,axis.text.x = element_text(angle=60, hjust = 1) # Uncomment if X-axis unreadable
)
summary(lm(d$PercOfPolsSupp ~ d$support))$r.squared
ggplot(d, aes(x=d$PercOfPolsSupp,
y=(d$support / 100), color=Majority)) +
geom_point(shape=1) + #scale_x_log10() +
scale_color_manual(values = c(purple, pinkish_red, dark_blue)) +
geom_smooth(method=lm, color = "grey") +
my.theme + ggtitle("Political Support Correlated to Public Opinion") +
xlab("Percent of State's Politicans Who Support - R-Sq=.79")+
ylab("Percent Who Say They Support in Recent Polls") +
scale_y_continuous(labels = percent) +
scale_x_continuous(labels = percent)
ggsave("./plots/plot01.png", dpi=300, width=5, height=4)
ggplot(d, aes(x=d$PercOfPolsOpp,
y=(d$X..opposition / 100), color=Majority)) +
geom_point(shape=1) + #scale_x_log10() +
scale_color_manual(values = c(purple, pinkish_red, dark_blue)) +
geom_smooth(method=lm, color = "grey") +
my.theme + ggtitle("Political Opposition Correlated to Public Opinion") +
xlab("Percent of State's Politicans Who Oppose - R-Sq=.79")+
ylab("Percent Who Say They Oppose in Recent Polls") +
scale_y_continuous(labels = percent) +
scale_x_continuous(labels = percent)
ggsave("./plots/plot02.png", dpi=300, width=5, height=4)
d.top <- d[which(d$PercOfPolsOpp == 1),]
ggplot(d.top, aes(x=reorder(d.top$state, -d.top$POPEST18PLUS2013), y=d.top$POPEST18PLUS2013)) + geom_bar(colour="white", fill=middle_blue) +
my.theme + ggtitle("All States Where 100% of Politicans Oppose") + xlab("State")+
ylab("18+ Population") +
scale_y_continuous(labels = comma)
ggsave("./plots/plot03.png", dpi=300, width=5, height=4)
d.top <- d[which(d$PercOfPolsSupp == 1),]
ggplot(d.top, aes(x=reorder(d.top$state, -d.top$POPEST18PLUS2013), y=d.top$POPEST18PLUS2013)) +
geom_bar(colour="white", fill=dark_blue) +
my.theme + ggtitle("All States Where 100% of Politicans Support") + xlab("State")+
ylab("18+ Population") +
scale_y_continuous(labels = comma)
ggsave("./plots/plot04.png", dpi=300, width=5, height=4)
ggplot(d, aes(x=(d$support / 100))) + geom_histogram(colour="white", fill=dark_blue, binwidth = .05) +
my.theme + ggtitle("Public Support for Gay Marriage") +
xlab("Percent of State Who Say They Support")+
ylab("Number of States") +
scale_x_continuous(labels = percent)
ggsave("./plots/plot05.png", dpi=300, width=5, height=4)
ggplot(d, aes(x=d$PercOfPolsSupp)) + geom_histogram(colour="white", fill=dark_blue, binwidth = .1) +
my.theme + ggtitle("Political Support for Gay Marriage") +
xlab("% of State Politicians Who Support")+
ylab("Number of States") +
scale_x_continuous(labels = percent)
ggsave("./plots/plot06.png", dpi=300, width=5, height=4)
d.top <- d[which(d$GovsOppose == 1 & d$support > 50),]
ggplot(d.top, aes(x=reorder(d.top$state, -d.top$POPEST18PLUS2013), y=d.top$POPEST18PLUS2013)) + geom_bar(colour="white", fill=middle_blue) +
my.theme + ggtitle("Governor Opposes But the Majority Support") + xlab("State")+
ylab("18+ Population") +
scale_y_continuous(labels = comma)
ggsave("./plots/plot07.png", dpi=300, width=5, height=4)
d.top <- d[which(d$SenatorsOppose >= 1 & d$support > 50),]
ggplot(d.top, aes(x=reorder(d.top$state, -d.top$POPEST18PLUS2013), y=d.top$POPEST18PLUS2013)) + geom_bar(colour="white", fill=middle_blue) +
my.theme + ggtitle("A Senator Opposes But the Majority Support") + xlab("State")+
ylab("18+ Population") +
scale_y_continuous(labels = comma)
ggsave("./plots/plot08.png", dpi=300, width=5, height=4)
# Politicians For and Against Gay Marriage
# Created by Daniel Hadley to analyze the support for gay marriage
# Nov, 2014
# setwd("/Users/dphnrome/Documents/Git/SameSexMarriage/")
setwd("C:/Users/dhadley/Documents/GitHub/SameSexMarriage")
#### Load packages and data ####
# Warning: installing my modified version seems to override the official package
library('devtools')
install_github(repo='choroplethrModified', username ="DanielHadley")
# load data, which was scraped from wikipedia on Nov 16th, 2014
PolsByState <- read.csv("./data/PolsByState.csv")
PollsByState <- read.csv("./data/PollsByState.csv")
library(choroplethr)
library(choroplethrMaps)
library(ggplot2)
library(gridExtra)
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- PolsByState$GovsSupport
choro = StateChoropleth$new(PolsByState)
choro$title = "Governors Who Support Gay Marriage"
choro$ggplot_scale = scale_fill_manual(name="Candidate", values=c("blue", "red"))
choro$render()
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- PolsByState$GovsSupport
choro = StateChoropleth$new(PolsByState)
choro$title = "Governors Who Support Gay Marriage"
choro$ggplot_scale = scale_fill_manual(name="Support", values=c("#0c2c84", "#1d91c0"))
choro$render()
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- PolsByState$GovsSupport
choro = StateChoropleth$new(PolsByState)
choro$title = "Governors Who Support Gay Marriage"
choro$ggplot_scale = scale_fill_manual(name="Support", values=c("#1d91c0", "#0c2c84"))
choro$render()
# Gov Oppose
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- PolsByState$GovsSupport
choro = StateChoropleth$new(PolsByState)
choro$title = "Governors Who Oppose Gay Marriage"
choro$ggplot_scale = scale_fill_manual(name="Oppose", values=c("#0c2c84", "#1d91c0"))
choro$render()
PolsByState$region <- tolower(PolsByState$state)
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- PolsByState$SenatorsOppose
state_choropleth(PolsByState,
title   = "Public Opposition to Gay Marriage",
legend  = "% Opposed")
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- PolsByState$SenatorsOppose
choro = StateChoropleth$new(PolsByState)
choro$title = "Senators Who Oppose Gay Marriage"
choro$ggplot_scale = scale_fill_manual(name="Oppose", values=c("#c7e9b4", "#0c2c84", "#1d91c0"))
choro$render()
choro = StateChoropleth$new(PolsByState)
choro$title = "Senators Who Oppose Gay Marriage"
choro$ggplot_scale = scale_fill_manual(name="Oppose", values=c("#c7e9b4", "#1d91c0", "#0c2c84"))
choro$render()
# Senators For
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- PolsByState$SenatorsSupport
choro = StateChoropleth$new(PolsByState)
choro$title = "Senators Who Support Gay Marriage"
choro$ggplot_scale = scale_fill_manual(name="Oppose", values=c("#c7e9b4", "#1d91c0", "#0c2c84"))
choro$render()
# Politician Support
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- round(PolsByState$PercOfPolsSupp * 100)
state_choropleth(PolsByState,
title   = "Politicians Who Support Gay Marriage",
legend  = "% Support")
ggsave(paste("./plots/Map1.png"), dpi=300, width=7, height=4)
# Public Support
PollsByState$region <- tolower(PollsByState$state)
PollsByState$value <- PollsByState$support
state_choropleth(PollsByState,
title   = "Public Support for Gay Marriage",
legend  = "% Support")
ggsave(paste("./plots/Map2.png"), dpi=300, width=7, height=4)
# Opposed
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- round(PolsByState$PercOfPolsOpp * 100)
state_choropleth(PolsByState,
title   = "Politicians Who Oppose Gay Marriage",
legend  = "% Opposed")
ggsave(paste("./plots/Map3.png"), dpi=300, width=7, height=4)
# Public Opposition
PollsByState$region <- tolower(PollsByState$state)
PolsByState$value <- PollsByState$X..opposition
state_choropleth(PollsByState,
title   = "Public Opposition to Gay Marriage",
legend  = "% Opposed")
ggsave(paste("./plots/Map4.png"), dpi=300, width=7, height=4)
# Gov Support
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- PolsByState$GovsSupport
choro = StateChoropleth$new(PolsByState)
choro$title = "Governors Who Support Gay Marriage"
choro$ggplot_scale = scale_fill_manual(name="Support", values=c("#1d91c0", "#0c2c84"))
choro$render()
ggsave(paste("./plots/Map5.png"), dpi=300, width=7, height=4)
# Gov Oppose
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- PolsByState$GovsOppose
choro = StateChoropleth$new(PolsByState)
choro$title = "Governors Who Oppose Gay Marriage"
choro$ggplot_scale = scale_fill_manual(name="Oppose", values=c("#0c2c84", "#1d91c0"))
choro$render()
ggsave(paste("./plots/Map6.png"), dpi=300, width=7, height=4)
# Senators Opposition
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- PolsByState$SenatorsOppose
choro = StateChoropleth$new(PolsByState)
choro$title = "Senators Who Oppose Gay Marriage"
choro$ggplot_scale = scale_fill_manual(name="Oppose", values=c("#c7e9b4", "#1d91c0", "#0c2c84"))
choro$render()
ggsave(paste("./plots/Map7.png"), dpi=300, width=7, height=4)
# Senators For
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- PolsByState$SenatorsSupport
choro = StateChoropleth$new(PolsByState)
choro$title = "Senators Who Support Gay Marriage"
choro$ggplot_scale = scale_fill_manual(name="Oppose", values=c("#c7e9b4", "#1d91c0", "#0c2c84"))
choro$render()
ggsave(paste("./plots/Map8.png"), dpi=300, width=7, height=4)
# Gov Support
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- PolsByState$GovsSupport
choro = StateChoropleth$new(PolsByState)
choro$title = "Governors Who Support Gay Marriage"
choro$ggplot_scale = scale_fill_manual(name="Support", values=c("#1d91c0", "#0c2c84"))
choro$render()
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- PolsByState$GovsOppose
choro = StateChoropleth$new(PolsByState)
choro$title = "Governors Who Oppose Gay Marriage"
choro$ggplot_scale = scale_fill_manual(name="Oppose", values=c("#0c2c84", "#1d91c0"))
choro$render()
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- PolsByState$GovsOppose
choro = StateChoropleth$new(PolsByState)
choro$title = "Governors Who Oppose Gay Marriage"
choro$ggplot_scale = scale_fill_manual(name="Oppose", values=c("#1d91c0", "#0c2c84"))
choro$render()
# Politicians For and Against Gay Marriage
# Created by Daniel Hadley to analyze the support for gay marriage
# Nov, 2014
# setwd("/Users/dphnrome/Documents/Git/SameSexMarriage/")
setwd("C:/Users/dhadley/Documents/GitHub/SameSexMarriage")
#### Load packages and data ####
# Warning: installing my modified version seems to override the official package
library('devtools')
install_github(repo='choroplethrModified', username ="DanielHadley")
# load data, which was scraped from wikipedia on Nov 16th, 2014
PolsByState <- read.csv("./data/PolsByState.csv")
PollsByState <- read.csv("./data/PollsByState.csv")
library(choroplethr)
library(choroplethrMaps)
library(ggplot2)
library(gridExtra)
# Politician Support
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- round(PolsByState$PercOfPolsSupp * 100)
state_choropleth(PolsByState,
title   = "Politicians Who Support Gay Marriage",
legend  = "% Support")
ggsave(paste("./plots/Map1.png"), dpi=300, width=7, height=4)
# Public Support
PollsByState$region <- tolower(PollsByState$state)
PollsByState$value <- PollsByState$support
state_choropleth(PollsByState,
title   = "Public Support for Gay Marriage",
legend  = "% Support")
ggsave(paste("./plots/Map2.png"), dpi=300, width=7, height=4)
# Opposed
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- round(PolsByState$PercOfPolsOpp * 100)
state_choropleth(PolsByState,
title   = "Politicians Who Oppose Gay Marriage",
legend  = "% Opposed")
ggsave(paste("./plots/Map3.png"), dpi=300, width=7, height=4)
# Public Opposition
PollsByState$region <- tolower(PollsByState$state)
PolsByState$value <- PollsByState$X..opposition
state_choropleth(PollsByState,
title   = "Public Opposition to Gay Marriage",
legend  = "% Opposed")
ggsave(paste("./plots/Map4.png"), dpi=300, width=7, height=4)
# Gov Support
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- PolsByState$GovsSupport
choro = StateChoropleth$new(PolsByState)
choro$title = "Governors Who Support Gay Marriage"
choro$ggplot_scale = scale_fill_manual(name="Support", values=c("#1d91c0", "#0c2c84"))
choro$render()
ggsave(paste("./plots/Map5.png"), dpi=300, width=7, height=4)
# Gov Oppose
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- PolsByState$GovsOppose
choro = StateChoropleth$new(PolsByState)
choro$title = "Governors Who Oppose Gay Marriage"
choro$ggplot_scale = scale_fill_manual(name="Oppose", values=c("#1d91c0", "#0c2c84"))
choro$render()
ggsave(paste("./plots/Map6.png"), dpi=300, width=7, height=4)
# Senators Opposition
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- PolsByState$SenatorsOppose
choro = StateChoropleth$new(PolsByState)
choro$title = "Senators Who Oppose Gay Marriage"
choro$ggplot_scale = scale_fill_manual(name="Oppose", values=c("#c7e9b4", "#1d91c0", "#0c2c84"))
choro$render()
ggsave(paste("./plots/Map7.png"), dpi=300, width=7, height=4)
# Senators For
PolsByState$region <- tolower(PolsByState$State)
PolsByState$value <- PolsByState$SenatorsSupport
choro = StateChoropleth$new(PolsByState)
choro$title = "Senators Who Support Gay Marriage"
choro$ggplot_scale = scale_fill_manual(name="Oppose", values=c("#c7e9b4", "#1d91c0", "#0c2c84"))
choro$render()
ggsave(paste("./plots/Map8.png"), dpi=300, width=7, height=4)
